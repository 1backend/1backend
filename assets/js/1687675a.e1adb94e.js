"use strict";(self.webpackChunksingulatron_api_docs=self.webpackChunksingulatron_api_docs||[]).push([[5026],{80014:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"built-in-services/registry-svc","title":"Registry Svc","description":"The registry service is designed to maintain a database of service definitions, service instances and nodes.","source":"@site/docs/built-in-services/registry-svc.md","sourceDirName":"built-in-services","slug":"/built-in-services/registry-svc","permalink":"/docs/built-in-services/registry-svc","draft":false,"unlisted":false,"editUrl":"https://github.com/1backend/1backend/tree/main/docs-source/docs/built-in-services/registry-svc.md","tags":[{"inline":true,"label":"registry-service","permalink":"/docs/tags/registry-service"},{"inline":true,"label":"registry","permalink":"/docs/tags/registry"},{"inline":true,"label":"microservices","permalink":"/docs/tags/microservices"},{"inline":true,"label":"addresses","permalink":"/docs/tags/addresses"},{"inline":true,"label":"authentication","permalink":"/docs/tags/authentication"}],"version":"current","sidebarPosition":40,"frontMatter":{"sidebar_position":40,"tags":["registry-service","registry","microservices","addresses","authentication"]},"sidebar":"tutorialSidebar","previous":{"title":"Prompt Svc","permalink":"/docs/built-in-services/prompt-svc"},"next":{"title":"Deploy Svc","permalink":"/docs/built-in-services/deploy-svc"}}');var t=i(74848),r=i(28453);const o={sidebar_position:40,tags:["registry-service","registry","microservices","addresses","authentication"]},d="Registry Svc",a={},c=[{value:"Entities",id:"entities",level:2},{value:"Definition",id:"definition",level:3},{value:"Container based definition",id:"container-based-definition",level:4},{value:"Notes",id:"notes",level:4},{value:"Source code based definition",id:"source-code-based-definition",level:4},{value:"Instance",id:"instance",level:3},{value:"Deployment",id:"deployment",level:3},{value:"Node",id:"node",level:3},{value:"How It Works",id:"how-it-works",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"registry-svc",children:"Registry Svc"})}),"\n",(0,t.jsx)(n.p,{children:"The registry service is designed to maintain a database of service definitions, service instances and nodes."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["This page provides a high-level overview of ",(0,t.jsx)(n.code,{children:"Registry Svc"}),". For detailed information, refer to the ",(0,t.jsx)(n.a,{href:"/docs/1backend-api/register-instance",children:"Registry Svc API documentation"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"entities",children:"Entities"}),"\n",(0,t.jsx)(n.h3,{id:"definition",children:"Definition"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"Definition"})," or service definition consists of the following things:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"An ID"}),"\n",(0,t.jsx)(n.li,{children:"A container image to run and some additional information like the internal port exposed etc."}),"\n",(0,t.jsx)(n.li,{children:"A set of endpoint definitions (OpenAPI etc.)"}),"\n",(0,t.jsx)(n.li,{children:"The URL of different clients (JS, Go etc.)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"Definition"})," is an abstract concept that can not be called. For a callable entity look at ",(0,t.jsx)(n.code,{children:"Instance"}),"s. Definitions are basically things you can deploy as an instance with a deployment."]}),"\n",(0,t.jsx)(n.h4,{id:"container-based-definition",children:"Container based definition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"id: test-a\nimage:\n  name: hashicorp/http-echo\n  port: 8080\nhostPort: 8887\n"})}),"\n",(0,t.jsx)(n.h4,{id:"notes",children:"Notes"}),"\n",(0,t.jsx)(n.p,{children:"HostPorts are a temporary requirement until support for dynamic port assignment lands."}),"\n",(0,t.jsx)(n.h4,{id:"source-code-based-definition",children:"Source code based definition"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"id: test-b\nrepository:\n  url: https://github.com/1backend/1backend.git\n  containerFile: server/docker/Dockerfile\nhostPort: 9998\n"})}),"\n",(0,t.jsx)(n.h3,{id:"instance",children:"Instance"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"Instance"})," or a service instance is an actual running, callable instance of a ",(0,t.jsx)(n.code,{children:"Definition"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"Instance"})," consists of the following things:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Address information that can be used to internally address the ",(0,t.jsx)(n.code,{children:"Instance"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"A Deployment ID."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,t.jsxs)(n.p,{children:["Definitions become instances through the ",(0,t.jsx)(n.a,{href:"/docs/built-in-services/deploy-svc",children:"Deployment entity of the Deploy Service"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"node",children:"Node"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"Node"})," is a physical or virtual machine that runs a 1Backend server.\nMaintaining a list of nodes is important so the daemon can efficiently distribute workload across the nodes. It's the basis for all distributed features."]}),"\n",(0,t.jsx)(n.p,{children:"This is how a well configured node should look like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ oo nodes lis\nNODE ID    URL                                  LAST HEARTBEAT\nmyNodeId   http://myNetworkInternalHost:11337   8s ago\n"})}),"\n",(0,t.jsx)(n.p,{children:"For well configured nodes, the following must be present"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Each node should have a unique URL (eg. 127.0.0.1 for all nodes is not unique...)"}),"\n",(0,t.jsx)(n.li,{children:"Each node URL should be addressable by every node including themselves"}),"\n",(0,t.jsx)(n.li,{children:"A node ID should be defined to avoid the more error prone ID generation"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Here is how a suboptimally configured node looks like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"$ oo nodes lis\nNODE ID           URL                         LAST HEARTBEAT\nnode_eIfnt9CGJV   http://127.0.0.1:11337      8s ago\n"})}),"\n",(0,t.jsx)(n.p,{children:"For single node setups that can work, but not if you plan to use distributed features."}),"\n",(0,t.jsxs)(n.p,{children:["To configure the nodes, please see the ",(0,t.jsx)(n.code,{children:"OB_SELF_URL"})," and ",(0,t.jsx)(n.code,{children:"OB_NODE_ID"})," envars ",(0,t.jsx)(n.a,{href:"/docs/running-the-server/backend-environment-variables",children:"here"})]}),"\n",(0,t.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsx)(n.p,{children:"The registry is needed when you want to call services not included in the 1Backend server. You can think of the daemon as the standard library and services in the registry as third party libraries."}),"\n",(0,t.jsx)(n.p,{children:"When you want to call a service, you can ask the registry to provide you with a list of instance addresses for a service by service slug. Then you can use any of those instance addresses to make a call."}),"\n",(0,t.jsx)(n.p,{children:"Things like load balancing should be done on the client side at the moment, the damon does not provide a Proxy Svc yet."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>d});var s=i(96540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);