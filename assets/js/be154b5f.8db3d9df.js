"use strict";(self.webpackChunksingulatron_api_docs=self.webpackChunksingulatron_api_docs||[]).push([[1601],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>r});var l=s(96540);const i={},o=l.createContext(i);function a(e){const n=l.useContext(o);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(o.Provider,{value:n},e.children)}},71178:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"built-in-services/file-svc","title":"File Svc","description":"The File Svc is a distributed file storage and caching service that handles file uploads, downloads from external URLs, and content delivery across the 1Backend infrastructure.","source":"@site/docs/built-in-services/file-svc.md","sourceDirName":"built-in-services","slug":"/built-in-services/file-svc","permalink":"/docs/built-in-services/file-svc","draft":false,"unlisted":false,"editUrl":"https://github.com/1backend/1backend/tree/main/docs-source/docs/built-in-services/file-svc.md","tags":[{"inline":true,"label":"file-svc","permalink":"/docs/tags/file-svc"},{"inline":true,"label":"file","permalink":"/docs/tags/file"},{"inline":true,"label":"storage","permalink":"/docs/tags/storage"},{"inline":true,"label":"uploads","permalink":"/docs/tags/uploads"},{"inline":true,"label":"downloads","permalink":"/docs/tags/downloads"},{"inline":true,"label":"caching","permalink":"/docs/tags/caching"},{"inline":true,"label":"distributed","permalink":"/docs/tags/distributed"},{"inline":true,"label":"assets","permalink":"/docs/tags/assets"},{"inline":true,"label":"content-delivery","permalink":"/docs/tags/content-delivery"}],"version":"current","sidebarPosition":50,"frontMatter":{"sidebar_position":50,"tags":["file-svc","file","storage","uploads","downloads","caching","distributed","assets","content-delivery"]},"sidebar":"tutorialSidebar","previous":{"title":"Registry Svc","permalink":"/docs/built-in-services/registry-svc"},"next":{"title":"Policy Svc","permalink":"/docs/built-in-services/policy-svc"}}');var i=s(74848),o=s(28453);const a={sidebar_position:50,tags:["file-svc","file","storage","uploads","downloads","caching","distributed","assets","content-delivery"]},r="File Svc",d={},t=[{value:"Architecture &amp; Purpose",id:"architecture--purpose",level:2},{value:"Key Features",id:"key-features",level:3},{value:"CLI Usage",id:"cli-usage",level:2},{value:"Downloading &amp; Caching Files",id:"downloading--caching-files",level:3},{value:"File Uploads",id:"file-uploads",level:3},{value:"Serving Files",id:"serving-files",level:3},{value:"Distributed Architecture",id:"distributed-architecture",level:2},{value:"Multi-Node Storage",id:"multi-node-storage",level:3},{value:"File Replication &amp; Access",id:"file-replication--access",level:3},{value:"Node-Local Folders",id:"node-local-folders",level:3},{value:"File Types &amp; Management",id:"file-types--management",level:2},{value:"Downloads (External Files)",id:"downloads-external-files",level:3},{value:"Uploads (User Files)",id:"uploads-user-files",level:3},{value:"Integration Patterns",id:"integration-patterns",level:2},{value:"Container Assets (AI Models)",id:"container-assets-ai-models",level:3},{value:"Chat &amp; File Attachments",id:"chat--file-attachments",level:3},{value:"Data Svc Integration",id:"data-svc-integration",level:3},{value:"Real-World Usage Examples",id:"real-world-usage-examples",level:2},{value:"1. AI Model Management",id:"1-ai-model-management",level:3},{value:"2. Document Management System",id:"2-document-management-system",level:3},{value:"3. Content Delivery Network",id:"3-content-delivery-network",level:3},{value:"4. Backup &amp; Migration",id:"4-backup--migration",level:3},{value:"5. Multi-Media Processing",id:"5-multi-media-processing",level:3},{value:"File Serving &amp; Content Delivery",id:"file-serving--content-delivery",level:2},{value:"Content Headers",id:"content-headers",level:3},{value:"Direct File Access",id:"direct-file-access",level:3},{value:"Streaming &amp; Performance",id:"streaming--performance",level:3},{value:"File Security &amp; Access Control",id:"file-security--access-control",level:2},{value:"Secure File IDs",id:"secure-file-ids",level:3},{value:"Permission System",id:"permission-system",level:3},{value:"Service Integration Permissions",id:"service-integration-permissions",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Caching Strategy",id:"caching-strategy",level:3},{value:"Bandwidth Management",id:"bandwidth-management",level:3},{value:"Monitoring &amp; Observability",id:"monitoring--observability",level:2},{value:"Download Status Tracking",id:"download-status-tracking",level:3},{value:"Upload Management",id:"upload-management",level:3},{value:"Node Distribution",id:"node-distribution",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"<strong>Download Failures</strong>",id:"download-failures",level:4},{value:"<strong>File Not Found Errors</strong>",id:"file-not-found-errors",level:4},{value:"<strong>Upload Permission Errors</strong>",id:"upload-permission-errors",level:4},{value:"Debug Commands",id:"debug-commands",level:3},{value:"Storage Management",id:"storage-management",level:2},{value:"Disk Usage",id:"disk-usage",level:3},{value:"File Lifecycle",id:"file-lifecycle",level:3},{value:"API Reference Summary",id:"api-reference-summary",level:2},{value:"Related Services",id:"related-services",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Planned Features",id:"planned-features",level:3},{value:"Integration Roadmap",id:"integration-roadmap",level:3}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"file-svc",children:"File Svc"})}),"\n",(0,i.jsx)(n.p,{children:"The File Svc is a distributed file storage and caching service that handles file uploads, downloads from external URLs, and content delivery across the 1Backend infrastructure."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["This page provides a comprehensive overview of ",(0,i.jsx)(n.code,{children:"File Svc"}),". For detailed API information, refer to the ",(0,i.jsx)(n.a,{href:"/docs/1backend-api/download-file",children:"File Svc API documentation"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"architecture--purpose",children:"Architecture & Purpose"}),"\n",(0,i.jsxs)(n.p,{children:["File Svc serves as the ",(0,i.jsx)(n.strong,{children:"content management layer"})," for 1Backend, providing:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Distributed Storage"}),": Files are replicated across multiple nodes for reliability"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"URL Caching"}),": Downloads and caches external files for faster access"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Upload Management"}),": Handles multipart file uploads from clients"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Content Delivery"}),": Serves files with proper MIME types and headers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Asset Integration"}),": Automatically provides files to containers and services"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"key-features",children:"Key Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multi-Node Distribution"}),": Files stored across different nodes with automatic replication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Smart Proxying"}),": Serves files from the nearest available node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Resume Support"}),": Partial downloads with resume capability"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Security"}),": File access controls and secure file ID generation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance"}),": Intelligent caching and streaming for optimal delivery"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"cli-usage",children:"CLI Usage"}),"\n",(0,i.jsx)(n.p,{children:"File Svc doesn't have dedicated CLI commands. Instead, use the generic HTTP commands to interact with the API endpoints:"}),"\n",(0,i.jsx)(n.h3,{id:"downloading--caching-files",children:"Downloading & Caching Files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Download and cache a file from URL\noo put /file-svc/download \\\n  --url="https://example.com/large-model.gguf" \\\n  --folderPath="/downloads"\n\n# Get download status\noo get /file-svc/download/https%3A%2F%2Fexample.com%2Flarge-model.gguf\n\n# List all downloads\noo post /file-svc/downloads\n\n# Pause a download\noo put /file-svc/download/https%3A%2F%2Fexample.com%2Flarge-model.gguf/pause\n'})}),"\n",(0,i.jsx)(n.h3,{id:"file-uploads",children:"File Uploads"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Upload a file using curl (multipart form data)\ncurl -X PUT "http://localhost:11337/file-svc/upload" \\\n  -H "Authorization: Bearer $TOKEN" \\\n  -F "file=@./my-document.pdf"\n\n# List uploaded files\noo post /file-svc/uploads \\\n  --userId="usr_12345"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"serving-files",children:"Serving Files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Serve an uploaded file by file ID\ncurl "http://localhost:11337/file-svc/serve/upload/file_abc123xyz"\n\n# Serve a downloaded file by URL\ncurl "http://localhost:11337/file-svc/serve/download/https%3A%2F%2Fexample.com%2Fmodel.gguf"\n\n# Using with browser (downloads with proper filename)\nopen "http://localhost:11337/file-svc/serve/upload/file_abc123xyz"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"distributed-architecture",children:"Distributed Architecture"}),"\n",(0,i.jsx)(n.h3,{id:"multi-node-storage",children:"Multi-Node Storage"}),"\n",(0,i.jsxs)(n.p,{children:["File Svc operates in a ",(0,i.jsx)(n.strong,{children:"distributed manner"}),":"]}),"\n",(0,i.jsx)(n.mermaid,{value:"graph TB\n    User[User/Service] --\x3e LB[Load Balancer]\n    LB --\x3e Node1[Node 1<br/>File Svc]\n    LB --\x3e Node2[Node 2<br/>File Svc]\n    LB --\x3e Node3[Node 3<br/>File Svc]\n    \n    Node1 --\x3e Storage1[Local Storage<br/>uploads/, downloads/]\n    Node2 --\x3e Storage2[Local Storage<br/>uploads/, downloads/]\n    Node3 --\x3e Storage3[Local Storage<br/>uploads/, downloads/]\n    \n    Node1 -.->|Proxy Request| Node2\n    Node2 -.->|Proxy Request| Node3"}),"\n",(0,i.jsx)(n.h3,{id:"file-replication--access",children:"File Replication & Access"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Upload Replicas"}),": Files can be stored on multiple nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Smart Routing"}),": Requests automatically routed to nodes with the file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Transparent Proxying"}),": If a file isn't local, the request is proxied to the correct node"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unique File IDs"}),": Files have both local IDs and global file IDs for distributed access"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"node-local-folders",children:"Node-Local Folders"}),"\n",(0,i.jsx)(n.p,{children:"Each File Svc node maintains:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"~/.1backend/\n\u251c\u2500\u2500 uploads/          # User uploaded files\n\u2514\u2500\u2500 downloads/        # Cached external files\n"})}),"\n",(0,i.jsx)(n.h2,{id:"file-types--management",children:"File Types & Management"}),"\n",(0,i.jsx)(n.h3,{id:"downloads-external-files",children:"Downloads (External Files)"}),"\n",(0,i.jsx)(n.p,{children:"Downloads are external files cached locally for performance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Download an AI model\noo put /file-svc/download \\\n  --url="https://huggingface.co/microsoft/DialoGPT-medium/resolve/main/pytorch_model.bin" \\\n  --folderPath="/models"\n\n# Check download progress\noo get /file-svc/download/https%3A%2F%2Fhuggingface.co%2Fmicrosoft%2FDialoGPT-medium%2Fresolve%2Fmain%2Fpytorch_model.bin\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "exists": true,\n  "download": {\n    "id": "down_abc123",\n    "url": "https://huggingface.co/microsoft/DialoGPT-medium/resolve/main/pytorch_model.bin",\n    "fileName": "pytorch_model.bin",\n    "progress": 75.5,\n    "downloadedBytes": 890234567,\n    "fileSize": 1179648000,\n    "status": "InProgress",\n    "filePath": "/root/.1backend/downloads/encoded_filename"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"uploads-user-files",children:"Uploads (User Files)"}),"\n",(0,i.jsx)(n.p,{children:"Uploads are files submitted by users or services:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List user uploads\noo post /file-svc/uploads \\\n  --userId="usr_12345"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "uploads": [\n    {\n      "id": "upl_xyz789",\n      "fileId": "file_abc123def",\n      "fileName": "profile-picture.jpg",\n      "fileSize": 2048576,\n      "userId": "usr_12345",\n      "nodeId": "node_server01",\n      "createdAt": "2023-01-01T10:00:00Z"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"container-assets-ai-models",children:"Container Assets (AI Models)"}),"\n",(0,i.jsxs)(n.p,{children:["File Svc automatically integrates with ",(0,i.jsx)(n.a,{href:"/docs/built-in-services/container-svc",children:"Container Svc"})," for AI model downloads:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "image": "llama-cpp-python:latest",\n  "assets": [\n    {\n      "envVarKey": "MODEL_PATH",\n      "url": "https://huggingface.co/TheBloke/Mistral-7B-Instruct-v0.2-GGUF/resolve/main/mistral-7b-instruct-v0.2.Q4_K_M.gguf"\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Flow:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Container Svc requests the model file from File Svc"}),"\n",(0,i.jsx)(n.li,{children:"File Svc downloads and caches the model if not present"}),"\n",(0,i.jsx)(n.li,{children:"File is served to Container Svc and mounted in the container"}),"\n",(0,i.jsxs)(n.li,{children:["Environment variable ",(0,i.jsx)(n.code,{children:"MODEL_PATH"})," points to the file location"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"chat--file-attachments",children:"Chat & File Attachments"}),"\n",(0,i.jsxs)(n.p,{children:["Integration with ",(0,i.jsx)(n.a,{href:"/docs/built-in-services/chat-svc",children:"Chat Svc"})," for message attachments:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Upload attachment\ncurl -X PUT "http://localhost:11337/file-svc/upload" \\\n  -H "Authorization: Bearer $TOKEN" \\\n  -F "file=@./document.pdf"\n\n# Use file ID in chat message\noo post /chat-svc/thread/thread_123/message \\\n  --text="Here\'s the document" \\\n  --fileIds=\'["file_abc123def"]\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"data-svc-integration",children:"Data Svc Integration"}),"\n",(0,i.jsxs)(n.p,{children:["Store file references in ",(0,i.jsx)(n.a,{href:"/docs/built-in-services/data-svc",children:"Data Svc"})," objects:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Create object with file references\noo post /data-svc/object \\\n  --object.table="document" \\\n  --object.readers="_self" \\\n  --object.data.title="Project Report" \\\n  --object.data.attachments=\'["file_report123", "file_charts456"]\'\n'})}),"\n",(0,i.jsx)(n.h2,{id:"real-world-usage-examples",children:"Real-World Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"1-ai-model-management",children:"1. AI Model Management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Download a large language model\noo put /file-svc/download \\\n  --url="https://huggingface.co/microsoft/DialoGPT-large/resolve/main/pytorch_model.bin" \\\n  --folderPath="/models/dialogpt"\n\n# Check download progress\noo get /file-svc/download/https%3A%2F%2Fhuggingface.co%2Fmicrosoft%2FDialoGPT-large%2Fresolve%2Fmain%2Fpytorch_model.bin\n\n# Monitor until complete\nwatch -n 5 \'oo post /file-svc/downloads | grep -A 10 "DialoGPT"\'\n\n# Once complete, use in container\noo put /container-svc/container \\\n  --image="my-ai-service:latest" \\\n  --assets=\'[{"envVarKey": "MODEL_PATH", "url": "https://huggingface.co/microsoft/DialoGPT-large/resolve/main/pytorch_model.bin"}]\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-document-management-system",children:"2. Document Management System"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Upload user documents\ncurl -X PUT "http://localhost:11337/file-svc/upload" \\\n  -H "Authorization: Bearer $TOKEN" \\\n  -F "file=@./contract.pdf" \\\n  -F "file=@./invoice.xlsx"\n\n# List user\'s documents\noo post /file-svc/uploads \\\n  --userId="usr_company123"\n\n# Store document metadata in Data Svc\noo post /data-svc/object \\\n  --object.table="document" \\\n  --object.readers=\'["org_company123"]\' \\\n  --object.data.title="Q4 Contract" \\\n  --object.data.fileId="file_contract789" \\\n  --object.data.category="legal" \\\n  --object.data.uploadedBy="usr_john456"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-content-delivery-network",children:"3. Content Delivery Network"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Cache frequently accessed files\noo put /file-svc/download \\\n  --url="https://cdn.example.com/assets/logo.png" \\\n  --folderPath="/cdn-cache"\n\noo put /file-svc/download \\\n  --url="https://cdn.example.com/assets/style.css" \\\n  --folderPath="/cdn-cache"\n\n# Serve cached content (much faster than original CDN)\ncurl "http://localhost:11337/file-svc/serve/download/https%3A%2F%2Fcdn.example.com%2Fassets%2Flogo.png"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-backup--migration",children:"4. Backup & Migration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Download backup files\noo put /file-svc/download \\\n  --url="https://backups.mycompany.com/database-backup-2023-12.sql.gz" \\\n  --folderPath="/backups"\n\n# Upload processed files\ncurl -X PUT "http://localhost:11337/file-svc/upload" \\\n  -H "Authorization: Bearer $TOKEN" \\\n  -F "file=@./processed-data.csv"\n\n# List all cached backups\noo post /file-svc/downloads | grep backup\n'})}),"\n",(0,i.jsx)(n.h3,{id:"5-multi-media-processing",children:"5. Multi-Media Processing"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Download video for processing\noo put /file-svc/download \\\n  --url="https://example.com/raw-video.mp4" \\\n  --folderPath="/media/input"\n\n# Process and upload result\n# (after processing with video service)\ncurl -X PUT "http://localhost:11337/file-svc/upload" \\\n  -H "Authorization: Bearer $TOKEN" \\\n  -F "file=@./processed-video.mp4"\n\n# Create media object with references\noo post /data-svc/object \\\n  --object.table="media" \\\n  --object.readers="_self" \\\n  --object.data.title="Processed Video" \\\n  --object.data.originalFile="https://example.com/raw-video.mp4" \\\n  --object.data.processedFileId="file_processed123"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"file-serving--content-delivery",children:"File Serving & Content Delivery"}),"\n",(0,i.jsx)(n.h3,{id:"content-headers",children:"Content Headers"}),"\n",(0,i.jsx)(n.p,{children:"File Svc automatically sets appropriate headers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-http",children:'Content-Type: application/pdf\nContent-Disposition: attachment; filename="document.pdf"\nContent-Length: 2048576\n'})}),"\n",(0,i.jsx)(n.h3,{id:"direct-file-access",children:"Direct File Access"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Serve file directly (downloads with proper filename)\ncurl -O -J "http://localhost:11337/file-svc/serve/upload/file_abc123def"\n\n# Serve with custom application\nwget "http://localhost:11337/file-svc/serve/download/https%3A%2F%2Fexample.com%2Ffile.zip"\n\n# Embed in web pages\n# <img src="http://localhost:11337/file-svc/serve/upload/file_image123" />\n'})}),"\n",(0,i.jsx)(n.h3,{id:"streaming--performance",children:"Streaming & Performance"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Progressive Download"}),": Large files stream as they download"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Resume Support"}),": Interrupted downloads can resume from where they left off"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"MIME Detection"}),": Automatic content-type detection from file extensions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Efficient Proxying"}),": Minimal overhead when proxying between nodes"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"file-security--access-control",children:"File Security & Access Control"}),"\n",(0,i.jsx)(n.h3,{id:"secure-file-ids",children:"Secure File IDs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# File IDs are cryptographically secure\nfile_8kJ9pL2mN5qR7sT1vU3wX6yZ4aB7cD9eF2gH5iJ8k\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Non-enumerable"}),": Cannot guess other file IDs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Globally unique"}),": Safe across distributed system"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Opaque"}),": No information leaked about file contents"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"permission-system",children:"Permission System"}),"\n",(0,i.jsx)(n.p,{children:"File operations require specific permissions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Download permissions\nfile-svc:download:create    # Start downloads\nfile-svc:download:view      # List and check downloads\n\n# Upload permissions  \nfile-svc:upload:create      # Upload files\nfile-svc:upload:view        # List uploads\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-integration-permissions",children:"Service Integration Permissions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Container Svc can download assets\nmodel-svc -> file-svc:download:create\nmodel-svc -> file-svc:download:view\n\n# Prompt Svc can handle file uploads\nprompt-svc -> file-svc:upload:create\n"})}),"\n",(0,i.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,i.jsx)(n.h3,{id:"caching-strategy",children:"Caching Strategy"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Pre-download frequently used files\noo put /file-svc/download \\\n  --url="https://cdn.example.com/frequently-used.js" \\\n  --folderPath="/cache"\n\n# Batch download related files\noo put /file-svc/download \\\n  --url="https://example.com/model.gguf" \\\n  --folderPath="/models"\n\noo put /file-svc/download \\\n  --url="https://example.com/tokenizer.json" \\\n  --folderPath="/models"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"bandwidth-management",children:"Bandwidth Management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Monitor download progress\noo get /file-svc/download/https%3A%2F%2Fexample.com%2Flarge-file.zip\n\n# Pause heavy downloads during peak hours\noo put /file-svc/download/https%3A%2F%2Fexample.com%2Flarge-file.zip/pause\n\n# Resume when bandwidth available\noo put /file-svc/download \\\n  --url="https://example.com/large-file.zip" \\\n  --folderPath="/downloads"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"monitoring--observability",children:"Monitoring & Observability"}),"\n",(0,i.jsx)(n.h3,{id:"download-status-tracking",children:"Download Status Tracking"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List all downloads with status\noo post /file-svc/downloads\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Status Values:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Pending"}),": Download queued but not started"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"InProgress"}),": Currently downloading"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Completed"}),": Download finished successfully"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Paused"}),": Download temporarily paused"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Failed"}),": Download failed (can be retried)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"upload-management",children:"Upload Management"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Monitor user uploads\noo post /file-svc/uploads \\\n  --userId=\"usr_12345\"\n\n# Check storage usage per user\noo post /file-svc/uploads | jq '.uploads | group_by(.userId) | map({user: .[0].userId, count: length, totalSize: map(.fileSize) | add})'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"node-distribution",children:"Node Distribution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check which nodes have which files\noo post /file-svc/uploads | jq '.uploads | group_by(.nodeId)'\n\n# Monitor download distribution\noo post /file-svc/downloads | jq '.downloads | group_by(.nodeId // \"unknown\")'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsx)(n.h4,{id:"download-failures",children:(0,i.jsx)(n.strong,{children:"Download Failures"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Check download status\noo get /file-svc/download/https%3A%2F%2Fexample.com%2Ffile.zip\n\n# Retry failed download\noo put /file-svc/download \\\n  --url="https://example.com/file.zip" \\\n  --folderPath="/downloads"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"file-not-found-errors",children:(0,i.jsx)(n.strong,{children:"File Not Found Errors"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Verify file exists across nodes\noo post /file-svc/uploads | grep "file_abc123"\n\n# Check download replicas\noo post /file-svc/downloads | grep "example.com/file.zip"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"upload-permission-errors",children:(0,i.jsx)(n.strong,{children:"Upload Permission Errors"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Verify user permissions\noo get /user-svc/permits | grep "file-svc:upload"\n\n# Check authentication\noo whoami\n'})}),"\n",(0,i.jsx)(n.h3,{id:"debug-commands",children:"Debug Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List all file operations\noo post /file-svc/uploads\noo post /file-svc/downloads\n\n# Check specific file by ID\ncurl -I "http://localhost:11337/file-svc/serve/upload/file_abc123"\n\n# Verify URL encoding for downloads\nnode -e "console.log(encodeURIComponent(\'https://example.com/file.zip\'))"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"storage-management",children:"Storage Management"}),"\n",(0,i.jsx)(n.h3,{id:"disk-usage",children:"Disk Usage"}),"\n",(0,i.jsx)(n.p,{children:"File Svc stores files in predictable locations:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check upload storage usage\ndu -sh ~/.1backend/uploads/\n\n# Check download cache usage  \ndu -sh ~/.1backend/downloads/\n\n# Clean up old downloads (manual process)\nfind ~/.1backend/downloads/ -mtime +30 -delete\n"})}),"\n",(0,i.jsx)(n.h3,{id:"file-lifecycle",children:"File Lifecycle"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Downloads"}),": Cached indefinitely unless manually cleaned"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Uploads"}),": Persist until explicitly deleted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Replicas"}),": Multiple copies may exist across nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cleanup"}),": Currently manual (automatic cleanup planned)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"api-reference-summary",children:"API Reference Summary"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Endpoint"}),(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/download"})}),(0,i.jsx)(n.td,{children:"PUT"}),(0,i.jsx)(n.td,{children:"Start/resume download from URL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/download/{url}"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"Get download status"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/download/{url}/pause"})}),(0,i.jsx)(n.td,{children:"PUT"}),(0,i.jsx)(n.td,{children:"Pause active download"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/downloads"})}),(0,i.jsx)(n.td,{children:"POST"}),(0,i.jsx)(n.td,{children:"List all downloads"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/upload"})}),(0,i.jsx)(n.td,{children:"PUT"}),(0,i.jsx)(n.td,{children:"Upload file (multipart)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/uploads"})}),(0,i.jsx)(n.td,{children:"POST"}),(0,i.jsx)(n.td,{children:"List uploaded files"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/serve/upload/{fileId}"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"Serve uploaded file"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/file-svc/serve/download/{url}"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"Serve downloaded file"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"related-services",children:"Related Services"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/built-in-services/container-svc",children:"Container Svc"})}),": Automatic asset downloading for containers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/built-in-services/chat-svc",children:"Chat Svc"})}),": File attachments in messages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/built-in-services/data-svc",children:"Data Svc"})}),": Store file references in objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.a,{href:"/docs/built-in-services/model-svc",children:"Model Svc"})}),": AI model file management"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,i.jsx)(n.h3,{id:"planned-features",children:"Planned Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Automatic Cleanup"}),": Configurable retention policies for cached files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compression"}),": Automatic compression for large files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Deduplication"}),": Avoid storing duplicate files across nodes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Thumbnails"}),": Automatic thumbnail generation for images"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Virus Scanning"}),": Optional malware detection for uploads"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"integration-roadmap",children:"Integration Roadmap"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"CDN Integration"}),": Direct integration with external CDNs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cloud Storage"}),": Support for S3, Google Cloud, Azure blob storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"WebRTC"}),": Peer-to-peer file transfer for large files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Streaming"}),": Live video/audio streaming capabilities"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"File Svc provides the foundation for robust, distributed file management in 1Backend, supporting everything from AI model deployment to user content management."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);